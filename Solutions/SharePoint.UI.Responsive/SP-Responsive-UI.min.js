function responsiveStartup(){var e=PnPResponsiveApp.Main.getInstance();e.addViewport(),e.init()}window.hasOwnProperty("Type")?Type.registerNamespace("PnPResponsiveApp"):window.PnPResponsiveApp=window.PnPResponsiveApp||{},PnPResponsiveApp.Main=function(){function e(e,n){if(t(e,n)){var i=new RegExp("(\\s|^)"+n+"(\\s|$)");e.className=e.className.replace(i," ")}else e.className=e.className+" "+n}function t(e,t){try{return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}catch(e){return!1}}function n(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.appendChild(n)}function i(e){e.id=e.getAttribute("id")+"_mobileClone";for(var t=e.getElementsByTagName("*"),n=new RegExp("(.*?zz.*?(?:_SiteActionsMenuMain|_SiteActionsMenu))","g"),i=0;i<t.length;i++)if(t[i].id){for(var o=t[i].attributes,a=0;a<o.length;a++)"id"!=o[a].name&&(o[a].value=o[a].value.replace(n,"$1_mobileClone"));t[i].id=t[i].getAttribute("id")+"_mobileClone"}return e}function o(){if(!(window.location.href.indexOf("/settings.aspx")<0)){var e=document.getElementsByClassName("ms-siteSettings-root")[0];if(e){for(var t=e.getElementsByClassName("ms-linksection-level1"),n=0;n<t.length;n++){var i=t[n],a=document.createElement("div");a.className="pnp-settingsdiv",a.appendChild(i.getElementsByTagName("img")[0]),a.appendChild(i.getElementsByClassName("ms-linksection-textCell")[0]),e.appendChild(a)}e.getElementsByTagName("table")[0]&&e.removeChild(e.getElementsByTagName("table")[0])}else setTimeout(o,100)}}function a(){window.location.href.indexOf("/designbuilder.aspx")<0||v||l(_spPageContextInfo.currentCultureLCID,_spPageContextInfo.currentCultureName,".",document.getElementsByTagName("html")[0].getAttribute("dir"))}function l(e,t,n,i){try{new CUI.BuildOptions}catch(e){return}var o=new CUI.BuildOptions;o.lazyMenuInit=!0,o.trimmedIds={},o.attachToDOM=!1,o.validateServerRendering=!1,o.fixedPositioningEnabled=!1,o.dataExtensions=null,o.clientID="ms-designbuilder-cuicontainer_mobileClone";try{SP.Ribbon.PageManager.get_instance()}catch(e){return}var a=document.getElementById("ms-designbuilder-cuicontainer_mobileClone");if(Boolean(a)){a.innerHTML="";var l=new CUI.RootProperties;l.Culture=t,l.DecimalSeparator=n,l.RootEventCommand="designBuilderRootEventCommand",l.ImageDownArrow=GetThemedImageUrl("spcommon.png"),l.ImageDownArrowTop="-256",l.ImageDownArrowLeft="-104",l.TextDirection=i;var d=SP.Ribbon.PageManager.get_instance(),s=new CUI.Builder(o,a,d);g_designBuilderControlRoot=new CUI.StandaloneRoot("DesignBuilderTools",l),g_designBuilderControlRoot.setBuilder(s),d.addRoot(g_designBuilderControlRoot),r()}}function r(){var e=g_designData,t=g_designBuilderControlRoot,n=null,i=encodeURIComponent(e.newThemesLocation.toUpperCase()),o=!0,a="true"==e.overrideThemesLocation.toLowerCase();if(a){var l=g_desbld_designGuid,r=g_desbld_designVersion;o=null==g_desbld_designGuid||"undefined"==g_desbld_designGuid||null==g_desbld_designVersion||"undefined"==g_desbld_designVersion,n=GetSelectedDesignPackageFolder(o,l,r),null!=n&&""!=n&&(n=n.toUpperCase())}var d=document.getElementById("ms-designbuilder-cuicontainer_mobileClone"),s=CreateLabelElement(Strings.STS.L_DesignBuilderToolsPaletteLabel,"ms-designbuilder-palette-Medium");d.appendChild(s);var u,m,c,p=0,g=[],C=!1,f=g_desbld_themeUrl;for(m in e.themes)if(c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var h=e.themes[m];null==window.OffSwitch||OffSwitch.IsActive("F21AA66C-5CE7-4EA8-AE05-BA6E16A1A182")?C||decodeURI(h.ServerRelativeUrl.toUpperCase())!=decodeURI(f.toUpperCase())||(u=m,C=!0):C||unescapeProperly(h.ServerRelativeUrl.toUpperCase())!=unescapeProperly(f.toUpperCase())||(u=m,C=!0),g.push(CreatePaletteGalleryButtonXml(m,h,p++))}var B=g.join(""),y=['<DropDown Id="ms-designbuilder-palette" Alt="',Strings.STS.L_DesignBuilderToolsPaletteAlt,'" Command="PalettePickerSelected" QueryCommand="PalettePickerQuery" CommandPreview="PalettePickerPreview" CommandRevert="PalettePickerPreviewRevert" Width="111px" SelectedItemDisplayMode="Menu" InitialItem="',u,'"><Menu Id="DesignBuilderTools.Palette.Menu"><MenuSection Id="ms-designbuilder-palette-menusection" MaxHeight="269px" Scrollable="true"><Controls Id="DesignBuilderTools.Palette.Menu.MenuSection.Controls">',B,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.Palette",y.join(""));var P=t.getDOMElementForControlDisplayMode("DesignBuilderTools.Palette","Medium");d.appendChild(P);var b=CreateLabelElement(Strings.STS.L_DesignBuilderToolsLayoutLabel,"ms-designbuilder-layout-Medium");d.appendChild(b),p=0,g=[],C=!1,u=null;var E=g_desbld_masterUrl;for(m in e.preview)if(c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var S=e.preview[m];C||decodeURI(m.toUpperCase())!=decodeURI(E.toUpperCase())||(u=m,C=!0),g.push(CreateLayoutButtonXml(m,S,p++))}B=g.join("");var I=['<DropDown Id="ms-designbuilder-layout" Alt="',Strings.STS.L_DesignBuilderToolsLayoutAlt,'" Command="LayoutPickerSelected" QueryCommand="LayoutPickerQuery" CommandPreview="LayoutPickerPreview" CommandRevert="LayoutPickerPreviewRevert" Width="103px" InitialItem="',u,'"><Menu Id="DesignBuilderTools.Layout.Menu"><MenuSection Id="ms-designbuilder-layout-menusection"><Controls Id="DesignBuilderTools.Layout.Menu.MenuSection.Controls">',B,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.Layout",I.join(""));var D=t.getDOMElementForControlDisplayMode("DesignBuilderTools.Layout","Medium");d.appendChild(D);var w=CreateLabelElement(Strings.STS.L_DesignBuilderToolsFontLabel,"ms-designbuilder-fontscheme-Medium");d.appendChild(w),p=0,g=[],C=!1,u=null;var M=null===g_desbld_fontSchemeUrl?null:g_desbld_fontSchemeUrl;if(null===M||"DEFAULT"===M.toUpperCase()){var N=GetItemIgnoreCase(e.preview,E);Boolean(N)&&Boolean(N.defaultFontScheme)&&(M=N.defaultFontScheme)}var T,_=M.toUpperCase(),A=e.fontSchemeDuplicateKeyCount,L=new Array(A);for(m in e.fontSchemes)T=e.fontSchemeDuplicateKeys[m],Boolean(L[T])&&(C||decodeURI(m.toUpperCase())!=decodeURI(_))||(L[T]=m);C=!1;for(var U=0;U<L.length;U++)if(m=L[U],c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var R=e.fontSchemes[m];C||decodeURI(c)!=decodeURI(_)||(u=m,C=!0),g.push(CreateFontSchemeButtonXml(m,R,p++))}B=g.join("");var x=['<DropDown Id="ms-designbuilder-fontscheme" Alt="',Strings.STS.L_DesignBuilderToolsFontSchemeAlt,'" Command="FontSchemePickerSelected" QueryCommand="FontSchemePickerQuery" Width="132px" SelectedItemDisplayMode="Menu" InitialItem="',u,'"><Menu Id="DesignBuilderTools.FontScheme.Menu"><MenuSection Id="ms-designbuilder-fontscheme-menusection"><Controls Id="DesignBuilderTools.FontScheme.Menu.MenuSection.Controls">',B,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.FontScheme",x.join(""));var k=t.getDOMElementForControlDisplayMode("DesignBuilderTools.FontScheme","Medium");d.appendChild(k),t.pollForStateAndUpdate(),v=!0}function d(n){var o=document.getElementById(n),a=null;if(o){a=o.cloneNode(!0),a=i(a),a.className+=" ms-qSuggest-listSeparator";for(var l=a.querySelectorAll("li"),r=0;r<l.length;r++){var d=l[r].getElementsByClassName("menu-item")[0],s=document.createElement("div");s.className="ms-core-menu-item";var u=l[r].getElementsByTagName("ul");if(u.length>0&&d){t(l[r],"dynamic-children")||(l[r].className=l[r].className+" dynamic-children");var m=document.createElement("button");m.type="button",s.appendChild(m),m.addEventListener("click",function(){return e(this.parentNode.parentNode,"expand"),!1})}d&&(l[r].insertBefore(s,l[r].firstElementChild),s.appendChild(d)),l[r].insertBefore(s,l[r].firstElementChild);var c=l[r].querySelector("a.ms-navedit-editLinksText");c&&(c.removeAttribute("onclick"),c.href=_spPageContextInfo.webServerRelativeUrl+"/_layouts/15/AreaNavigationSettings.aspx")}}return a}function s(e,n){var i=!1;return n?i=!0:t(e,"pnp-nodeListener")||(e.className+=" pnp-nodeListener",e.addEventListener("DOMNodeInserted",function(){PnPResponsiveApp.Main.setUpToggling()})),i}function u(){var e=document.createElement("div");e.className="o365cs-nav-topItem o365cs-rsp-m-hide o365cs-rsp-tn-hideIfAffordanceOn mobile-only";var t=document.createElement("div"),n=document.createElement("button");n.type="button",n.className="o365cs-nav-item o365cs-nav-button ms-bgc-tdr-h o365button o365cs-topnavText o365cs-navMenuButton ms-bgc-tp ms-button-emphasize mobile-only",n.id="PnP_MainLink_Hamburger",n.setAttribute("role","menuitem"),n.setAttribute("aria-disabled","false"),n.setAttribute("aria-selected","false"),n.setAttribute("aria-label","Open the menu to access additional app options");var i=document.createElement("span");return i.className="ms-rteThemeBackColor-1-0 ms-Icon--GlobalNavButton",i.setAttribute("aria-hidden","true"),n.addEventListener("click",function(){return m(),a(),!1}),n.appendChild(i),t.appendChild(n),e.appendChild(t),e}function m(){var t=document.getElementById("PnPNavPanel"),n=document.getElementById("PnPPanelPage");t&&e(t,"PnPPanelEnabled"),n&&e(n,"PnPPanelEnabled")}var c,p=!1,g=!1,v=!1;return{init:function(){if(!p){var e,t=document.getElementById("PnPResponsiveUI");if(null!=t&&(e=t.src),null==e){var i=document.querySelectorAll("script[src*='sp-responsive-ui.js']");i.length>0&&(e=i[0].src)}if(null!=e){var a=e.substring(0,e.lastIndexOf("/")+1);n(a+"sp-responsive-ui.css")}PnPResponsiveApp.Main.setUpToggling(),PnPResponsiveApp.Main.setUpSuiteBarToogling(),o(),window.onhashchange=function(){o()};var l=FixRibbonAndWorkspaceDimensions;FixRibbonAndWorkspaceDimensions=function(){l(),document.getElementById("s4-bodyContainer").style.width=document.getElementById("s4-workspace").offsetWidth+"px"}}p=!0},addViewport:function(){if(!g){var e=document.getElementsByTagName("head")[0],t=document.createElement("meta");t.name="viewport",2==window.devicePixelRatio?t.content="width=device-width, user-scalable=yes, initial-scale=.5":t.content="width=device-width, user-scalable=yes, initial-scale=1.0";var n=document.createElement("meta");n.name="apple-mobile-web-app-capable",n.content="yes",e.appendChild(t),e.appendChild(n)}g=!0},setUpToggling:function(){var e=document.getElementsByClassName("ms-dialogBody");if(!(null!=e&&e.length>0||document.getElementById("PnP_MainLink_Hamburger"))){var t=document.getElementById("suiteBarTop"),n=null;if(t){if(n=t.getElementsByClassName("o365cs-nav-leftAlign")[0],!n){var i=t.querySelector("#O365_NavHeader");i&&(n=i.firstElementChild)}if(!s(t,n))return}else t=document.getElementById("suiteBar"),n=t.querySelector(".ms-verticalAlignMiddle"),n=n?n.parentNode:null;if(n){if(n.insertBefore(u(),n.firstElementChild),document.getElementById("PnPNavPanel"))return;var o=document.getElementById("suiteBarDelta");if(o||(o=document.getElementById("suiteBar")),!o)return;var a=document.createElement("div");a.id="PnPPanelPage";var l=document.createElement("div");l.id="PnPNavPanel",l.className="ms-rteThemeBackColor-1-0 ms-dialogHidden mobile-only ms-hide";var r=document.createElement("div");r.id="PnPContentNavPanel";var c=d("DeltaPlaceHolderProfileImage");c&&r.appendChild(c);var p=d("DeltaTopNavigation");p&&r.appendChild(p);var g=d("DeltaPlaceHolderLeftNavBar");g&&(r.appendChild(g),document.getElementById("DeltaPlaceHolderLeftNavBar").addEventListener("DOMSubtreeModified",function(){var e=document.getElementById("PnPContentNavPanel");if(e){var t=d(this.id),n=e.querySelector("#"+t.id);n&&n.parentNode.removeChild(n);var i=e.getElementsByClassName("PnPPanelBottom")[0];i?e.insertBefore(t,i):e.appendChild(t)}}));var v=d("DeltaHorizontalQuickLaunch");v&&r.appendChild(v);var C=document.createElement("div");C.className="PnPPanelBottom",r.appendChild(C),l.appendChild(r),o.parentElement.insertBefore(l,o.nextSibling),o.parentElement.insertBefore(a,l.nextSibling),a.addEventListener("click",function(){return m(),!1})}}},setUpSuiteBarToogling:function(){if(document.getElementById("suiteBar")){var t=document.createElement("button");t.id="pnp-suiteBar-open",t.className="mobile-only ms-button-emphasize",t.type="button";var n=document.createElement("span");n.className="ms-rteThemeBackColor-1-0",n.setAttribute("aria-hidden","true"),t.addEventListener("click",function(){document.getElementById("pnp-suiteBar")&&e(document.getElementById("pnp-suiteBar"),"ms-hide")}),t.appendChild(n),document.getElementById("DeltaSuiteLinks").appendChild(t)}PnPResponsiveApp.Main.setUpSuiteBarRwd()},setUpSuiteBarRwd:function(){if(!document.getElementById("pnp-suiteBar")&&document.getElementById("suiteBar")){var t=document.getElementById("suiteBarButtons"),n=t.cloneNode(!0);n=i(n);var o=document.getElementById("suiteLinksBox"),a=o.cloneNode(!0);a=i(a);var l=document.createElement("div");l.id="pnp-suiteBar",l.className="mobile-only ms-rteThemeBackColor-5-0 ms-hide";var r=document.createElement("button");r.id="pnp-suiteBar-close",r.type="button",r.className="ms-button-emphasize",r.addEventListener("click",function(){e(document.getElementById("pnp-suiteBar"),"ms-hide")}),l.appendChild(r),l.appendChild(n),l.appendChild(a),document.getElementById("suiteBar").parentNode.insertBefore(l,document.getElementById("suiteBar"))}},getInstance:function(){return c||(c=this),c}}}(),SP.SOD.executeFunc("sp.js","SP.ClientContext",responsiveStartup),_spBodyOnLoadFunctionNames.push("responsiveStartup");
